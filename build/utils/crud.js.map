{"version":3,"sources":["../../src/server/utils/crud.js"],"names":["getOne","model","req","res","findOne","createdBy","user","_id","params","id","lean","exec","doc","status","end","json","data","console","error","getMany","find","docs","createOne","create","body","updateOne","findOneAndUpdate","new","updatedDoc","removeOne","findOneAndRemove","removed","crudControllers"],"mappings":"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","sourcesContent":["export const getOne = model => async (req, res) => {\r\n  try {\r\n    const doc = await model\r\n      .findOne({ createdBy: req.user._id, _id: req.params.id })\r\n      .lean()\r\n      .exec();\r\n\r\n    if (!doc) {\r\n      return res.status(400).end();\r\n    }\r\n\r\n    res.status(200).json({ data: doc });\r\n  } catch (e) {\r\n    console.error(e);\r\n    res.status(400).end();\r\n  }\r\n};\r\n\r\nexport const getMany = model => async (req, res) => {\r\n  try {\r\n    const docs = await model\r\n      .find({ createdBy: req.user._id })\r\n      .lean()\r\n      .exec();\r\n\r\n    res.status(200).json({ data: docs });\r\n  } catch (e) {\r\n    console.error(e);\r\n    res.status(400).end();\r\n  }\r\n};\r\n\r\nexport const createOne = model => async (req, res) => {\r\n  const createdBy = req.user._id;\r\n  try {\r\n    const doc = await model.create({ ...req.body, createdBy });\r\n    res.status(201).json({ data: doc });\r\n  } catch (e) {\r\n    console.error(e);\r\n    res.status(400).end();\r\n  }\r\n};\r\n\r\nexport const updateOne = model => async (req, res) => {\r\n  try {\r\n    const updatedDoc = await model\r\n      .findOneAndUpdate(\r\n        {\r\n          createdBy: req.user._id,\r\n          _id: req.params.id\r\n        },\r\n        req.body,\r\n        { new: true }\r\n      )\r\n      .lean()\r\n      .exec();\r\n\r\n    if (!updatedDoc) {\r\n      return res.status(400).end();\r\n    }\r\n\r\n    res.status(200).json({ data: updatedDoc });\r\n  } catch (e) {\r\n    console.error(e);\r\n    res.status(400).end();\r\n  }\r\n};\r\n\r\nexport const removeOne = model => async (req, res) => {\r\n  try {\r\n    const removed = await model.findOneAndRemove({\r\n      createdBy: req.user._id,\r\n      _id: req.params.id\r\n    });\r\n\r\n    if (!removed) {\r\n      return res.status(400).end();\r\n    }\r\n\r\n    return res.status(200).json({ data: removed });\r\n  } catch (e) {\r\n    console.error(e);\r\n    res.status(400).end();\r\n  }\r\n};\r\n\r\nexport const crudControllers = model => ({\r\n  removeOne: removeOne(model),\r\n  updateOne: updateOne(model),\r\n  getMany: getMany(model),\r\n  getOne: getOne(model),\r\n  createOne: createOne(model)\r\n});\r\n"],"file":"crud.js"}